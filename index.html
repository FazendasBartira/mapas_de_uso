<!DOCTYPE html>
<html>
<title>Mapas Bartira - fazendas</title>
 <link href = "images/logo_bartira.ico" rel="icon">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="css/main.css">
<script src="js/ol.js"></script>
<link rel="stylesheet" href="css/ol.css">
<!-- Chamada ao arquivo com a configuração de camadas WMS -->
<script src="js/mapa.js"></script>
<body>

<!-- Navbar (sit on top) -->
<div class="w3-top">
  <div class="w3-bar w3-white w3-wide w3-padding w3-card">
    <a href="#home" class="w3-bar-item w3-button" style="font-family: Ubuntu; font-size: large;">Mapas <b>de Uso</b></a>
    <!-- Float links to the right. Hide them on small screens -->
    <div class="w3-right w3-hide-small">
        <a href="#projects" class="w3-bar-item wprojeto_curso:Dados de Desmatamento w3-button">Link mapas das fazendas</a>
        <a href="#contact" class="w3-bar-item wprojeto_curso:Dados de Desmatamento w3-button">Mapa</a>
    </div>
  </div>
</div>

<!-- Imagem Principal -->
<header class="w3-display-container w3-content w3-wide" style="max-width:1000px;" id="home";  >
  <center><img class="w3-image" src="images/Guarabu.PNG" alt="Architecture" width="1000" height="700" ></center>
  <center><figcaption> Vista da fazenda Guarabu,dezembro de 2022 </figcaption></center>
</header>

<!-- Conteúdo -->
<div class="w3-content w3-padding" style="max-width:1564px">

  <!-- Sessão com link para as aulas -->
  <div class="w3-container w3-padding-32" id="projects">
    <h3 class="w3-border-bottom w3-border-light-grey w3-padding-16">fazendas - Links para os mapas de uso</h3>
  </div>

  <div class="w3-row-padding">
    <div class="w3-col l3 m6 w3-margin-bottom">
      <div class="w3-display-container">
        <div class="w3-display-topleft w3-black w3-padding"><a href="qgis/Alvorada/Alvorada.html">Fazenda Alvorada</a>
		
		</div>
        <img src="images/mapa_uso_alvorada.jpeg" alt="House" style="width:50%">
		
		
      </div>
    </div>
    <div class="w3-col l3 m6 w3-margin-bottom">
      <div class="w3-display-container">
        <div class="w3-display-topleft w3-black w3-padding"><a href="qgis/Flores/Flores.html">Fazenda Flores</div>
        <img src="images/flores.jpeg" alt="Flores" style="width:50%">
      </div>
    </div>
    <div class="w3-col l3 m6 w3-margin-bottom">
      <div class="w3-display-container">
        <div class="w3-display-topleft w3-black w3-padding"><a href="qgis/San_Antonio/San_Antonio.html">Fazenda San Antonio</div>
        <img src="images/SanAntonio.jpeg" alt="House" style="width:50%">
      </div>
    </div>
    <div class="w3-col l3 m6 w3-margin-bottom">
      <div class="w3-display-container">
        <div class="w3-display-topleft w3-black w3-padding"><a href="qgis/SanDiego/SanDiego.html">Fazenda San Diego</div>
        <img src="images/SanDiego.jpeg" alt="House" style="width:50%">
      </div>
    </div>
    </div>

    <div class="w3-row-padding">
    <div class="w3-col l3 m6 w3-margin-bottom">
      <div class="w3-display-container">
        <div class="w3-display-topleft w3-black w3-padding"><a href="qgis/Colorado/Colorado.html">Fazenda Colorado</div>
        <img src="images/Colorado.jpeg" alt="House" style="width:50%">
      </div>
    </div>
    <div class="w3-col l3 m6 w3-margin-bottom">
      <div class="w3-display-container">
        <div class="w3-display-topleft w3-black w3-padding"><a href="qgis/Kuluene/Kuluene.html">Fazenda Kuluene</div>
        <img src="images/Kuluene.jpeg" alt="House" style="width:50%">
      </div>
    </div>
    <div class="w3-col l3 m6 w3-margin-bottom">
      <div class="w3-display-container">
        <div class="w3-display-topleft w3-black w3-padding"><a href="qgis/San_Jorge/San_Jorge.html">Fazenda San Jorge</div>
        <img src="images/San_Jorge.jpeg" alt="House" style="width:50%">
      </div>
    </div>
    <div class="w3-col l3 m6 w3-margin-bottom">
      <div class="w3-display-container">
        <div class="w3-display-topleft w3-black w3-padding"><a href="qgis/San_Jose_I/San_Jose_I.html">Fazenda San José I</div>
        <img src="images/San_Jose_I.jpeg" alt="House" style="width:50%">
      </div>
    </div>
    </div>
    <div class="w3-row-padding">
      <div class="w3-col l3 m6 w3-margin-bottom">
       <div class="w3-display-container">
        <div class="w3-display-topleft w3-black w3-padding"><a href="qgis/Talisma/Talisma.html">Fazenda Talismã</div>
        <img src="images/Talisma.jpg" alt="House" style="width:50%">
      </div>
    </div>
    <div class="w3-col l3 m6 w3-margin-bottom">
      <div class="w3-display-container">
        <div class="w3-display-topleft w3-black w3-padding"><a href="qgis/San_Jose_II/San_Jose_II.html">Fazenda San José II</div>
        <img src="images/San_Jose_II.jpeg" alt="House" style="width:50%">
      </div>
    </div>
	  <div class="w3-col l3 m6 w3-margin-bottom">
      <div class="w3-display-container">
        <div class="w3-display-topleft w3-black w3-padding"><a href="qgis/Guarabu/Guarabu.html">Fazenda Guarabu</div>
        <img src="images/Guarabu.jpeg" alt="House" style="width:50%">
      </div>
    </div>
    <div class="w3-col l3 m6 w3-margin-bottom">
      <div class="w3-display-container">
        <div class="w3-display-topleft w3-black w3-padding"><a href="qgis/Sublime/Sublime.html">Fazenda Sublime</div>
        <img src="images/sublime.jpeg" alt="House" style="width:50%">
      </div>
    </div>
    <div class="w3-col l3 m6 w3-margin-bottom">
      <!-- Espaço vazio para manter o layout -->
    </div>
    <div class="w3-col l3 m6 w3-margin-bottom">
      <!-- Espaço vazio para manter o layout -->
    </div>
  </div>

  <!-- Sessão da aplicação WebMap da página principal -->
  <div class="w3-container w3-padding-32" id="contact">
    <h3 class="w3-border-bottom w3-border-light-grey w3-padding-16">Mapa Unidades Bartira</h3>
    <div class="w3-container">
        <div class="mapa">
            <div class="map" id="map">
                <!-- Aqui é onde o OpenLayers vai desenhar o mapa -->
            </div>
			<div class="info" id="info">
				<h4 class="w3-center" id="nomeUnidade">Selecione uma
				Unidade</h4>
				<hr>
				<p><b>Nome Extenso</b>: <spam id="nomeExtenso"></spam></p>
				<p><b>Latitude</b>: <spam id="lat"></spam></p>
				<p><b>Longitude</b>: <spam id="long"></spam></p>
				<p><b>Fonte</b>: <spam id="fonte"></spam></p>
			</div>
        </div>
    </div>
  </div>
</div>
<!-- Footer -->
<footer class="w3-center w3-black w3-padding-16">
  <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" title="W3.CSS" target="_blank" class="w3-hover-text-green">w3.css</a></p>
</footer>
<script type="text/javascript">
  //Inserir aqui o código para criação do mapa na tela principal
      // Criando a camada de mapabase OSM
      var osm = new ol.layer.Tile({
              source: new ol.source.OSM()
          });
      //Chamada para a camada de Unidades da SEMA-MT
    var semaWMS = new ol.source.TileWMS({
                      url: 'http://localhost:8080/geoserver/projeto_final/wms',
                      params: {'LAYERS':'projeto_final:Unidades_SEMA_MT', 'TILED':false},
                      serverType: 'geoserver',  
                  });
      var unSema = new ol.layer.Tile({
                  source: semaWMS,
                  visible: true,
                  className: 'UnidadesSEMA',
          });
      var municipios = new ol.layer.Tile({
                  source: new ol.source.TileWMS({
                      url: 'http://localhost:8080/geoserver/projeto_final/wms',
                      params: {'LAYERS':'projeto_final:Municipios_MT', 'TILED':true},
                      serverType: 'municipiosMT',  
                  }),
                  visible: true,
                  className: 'Desmatamento',
          });
    var visualizacao = new ol.View({
          center: ol.proj.fromLonLat([-55.89, -13.47]),
          zoom: 6
        });
      var map = new ol.Map({
        target: 'map',
        layers: [osm, municipios, unSema],
        view: visualizacao
  
      });
    //Chamada serviço WMS de consulta às informações de feição
    map.on('singleclick', function (evt) {
      // Função que retorna o painnel de informação para seu estado original
      zeraConteudo();
      var viewResolution = /** @type {number} */ (visualizacao.getResolution());
      var url = semaWMS.getFeatureInfoUrl(
        evt.coordinate,
        viewResolution,
        'EPSG:3857',
        {'INFO_FORMAT': 'application/json'}
  
        );
      if (url) {
        fetch(url)
          .then(function (response) { return response.text(); })
          .then(function (html) {
            var objJSON = JSON.parse(html);
            //alert(Object.keys(objJSON.features[0].properties))
            var propriedades = objJSON.features[0].properties;
            document.getElementById("nomeUnidade").innerHTML = propriedades.NOME;
            document.getElementById("nomeExtenso").innerHTML = propriedades.NOME_EXTEN;
            document.getElementById("lat").innerHTML = propriedades.LAT;
            document.getElementById("long").innerHTML = propriedades.LONG;
            document.getElementById("fonte").innerHTML = propriedades.FONTE;
          });
        }
    });
    function zeraConteudo(){
      document.getElementById("nomeUnidade").innerHTML = "Selecione uma Unidade";
      document.getElementById("nomeExtenso").innerHTML = "";
      document.getElementById("lat").innerHTML = "";
      document.getElementById("long").innerHTML = "";
      document.getElementById("fonte").innerHTML = "";
    }
    </script>
  </body>
  </html>